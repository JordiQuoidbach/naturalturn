% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/process.R
\name{natural_turn_batch}
\alias{natural_turn_batch}
\title{Process Batch of Conversations with NaturalTurn Algorithm}
\usage{
natural_turn_batch(
  transcripts_df,
  output_csv = NULL,
  max_pause = 1.5,
  backchannel_word_max = 3,
  backchannel_proportion = 0.5,
  interruption_duration_min = 6,
  interruption_lag_duration_min = 1,
  conversation_id_col = NULL,
  speaker_col = NULL,
  text_col = "text",
  start_col = "time.s",
  stop_col = "time.e"
)
}
\arguments{
\item{transcripts_df}{Data frame containing transcript data for multiple
conversations. Must contain a column to identify different conversations
(e.g., \code{conversation_id}).}

\item{output_csv}{Optional path to save results as CSV file. If \code{NULL},
results are only returned (not saved to disk). Default: \code{NULL}.}

\item{max_pause}{Maximum pause (seconds) between consecutive segments from
the same speaker to be merged. Default: 1.5.}

\item{backchannel_word_max}{Maximum word count for backchannel classification.
Default: 3.}

\item{backchannel_proportion}{Minimum proportion of words that must be
backchannel cues. Default: 0.5.}

\item{interruption_duration_min}{Minimum duration (seconds) for a turn to be
considered an interruption. Default: 6.0.}

\item{interruption_lag_duration_min}{Minimum duration (seconds) of the
previous turn for current turn to be an interruption. Default: 1.0.}

\item{conversation_id_col}{Name of column containing conversation identifier.
Default: auto-detects "conversation_id" or "nego_id".}

\item{speaker_col}{Name of column containing speaker identifier.
Default: auto-detects "email", "speaker", or "role".}

\item{text_col}{Name of column containing utterance text. Default: "text".}

\item{start_col}{Name of column containing start time in seconds. Default: "time.s".}

\item{stop_col}{Name of column containing stop time in seconds. Default: "time.e".}
}
\value{
Data frame with processed turns for all conversations. Also saves
  results to CSV (and RDS) if \code{output_csv} is provided.
}
\description{
Processes multiple conversations from a data frame, applying the NaturalTurn
algorithm to each conversation separately and combining results.
}
\details{
This function:
  \itemize{
    \item Groups by \code{conversation_id_col} and processes each conversation separately
    \item Automatically detects speaker column (\code{email} preferred over \code{speaker} or \code{role})
    \item Preserves all metadata columns from the original data
    \item Combines results and optionally saves to CSV and RDS formats
  }

  The RDS format preserves list columns (e.g., \code{utterance_listener_list})
  in their native R format, while CSV converts them to JSON-style strings.
}
\section{Parameter Guide}{

\describe{
  \item{\code{max_pause}}{Maximum pause between consecutive speech segments
    from the SAME speaker to be merged into one turn. Pauses > max_pause
    WITHIN a merged turn are tracked in \code{internal_pause_*} columns.}
  \item{\code{backchannel_word_max}}{Maximum word count for an overlapping
    utterance to be considered a "backchannel" (vs "secondary").}
  \item{\code{backchannel_proportion}}{Minimum proportion of words that must
    be backchannel cues for a short utterance to be classified as backchannel.}
  \item{\code{interruption_duration_min}}{Minimum duration for a turn to be
    considered an interruption (Farley 2008 criteria).}
  \item{\code{interruption_lag_duration_min}}{Minimum duration of the previous
    turn for current turn to be an interruption.}
}
}

\examples{
\dontrun{
# Load your transcripts data frame
transcripts <- read.csv("transcripts.csv")

# Process all conversations
result <- natural_turn_batch(
  transcripts,
  conversation_id_col = "conversation_id",
  speaker_col = "speaker",
  text_col = "text",
  start_col = "start_time",
  stop_col = "end_time"
)

# Optionally save to CSV
result <- natural_turn_batch(
  transcripts,
  output_csv = "processed_transcripts.csv",
  conversation_id_col = "conversation_id"
)
}

}
\references{
\itemize{
    \item Cooney, G., & Reece, A. (2025). NaturalTurn: A method to segment
      speech into psychologically meaningful conversational turns. \emph{Scientific Reports},
      15, 39155. \url{https://doi.org/10.1038/s41598-025-24381-1}
    \item Di Stasi, M., Templeton, E., & Quoidbach, J. (2024). Zooming out on
      bargaining tables: Exploring which conversation dynamics predict negotiation
      outcomes. \emph{Journal of Applied Psychology}, 109, 1077-1093.
  }

  This package is an R implementation of the Python companion repository:
  \url{https://github.com/betterup/natural-turn-transcription}
}
